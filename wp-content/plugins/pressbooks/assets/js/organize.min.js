var Pressbooks={oldPart:null,newPart:null,defaultOptions:{revert:!0,helper:"clone",zIndex:2700,distance:3,opacity:.6,placeholder:"ui-state-highlight",connectWith:".chapters",dropOnEmpty:!0,cursor:"crosshair",items:"tbody > tr",start:function(e,t){Pressbooks.oldPart=t.item.parents("table").attr("id")},stop:function(e,t){Pressbooks.newPart=t.item.parents("table").attr("id"),Pressbooks.update(t.item)}},frontMatterOptions:{revert:!0,helper:"clone",zIndex:2700,distance:3,opacity:.6,placeholder:"ui-state-highlight",dropOnEmpty:!0,cursor:"crosshair",items:"tbody > tr",start:function(e,t){},stop:function(e,t){Pressbooks.fmupdate(t.item)}},backMatterOptions:{revert:!0,helper:"clone",zIndex:2700,distance:3,opacity:.6,placeholder:"ui-state-highlight",dropOnEmpty:!0,cursor:"crosshair",items:"tbody > tr",start:function(e,t){},stop:function(e,t){Pressbooks.bmupdate(t.item)}},update:function(e){jQuery.ajax({beforeSend:function(){jQuery.blockUI.defaults.applyPlatformOpacityRules=!1,jQuery.blockUI({message:jQuery("#loader.chapter")})},url:ajaxurl,type:"POST",data:{action:"pb_update_chapter",new_part_order:jQuery("#"+Pressbooks.newPart).sortable("serialize"),old_part_order:jQuery("#"+Pressbooks.oldPart).sortable("serialize"),new_part:Pressbooks.newPart.replace(/^part\-([0-9]+)$/i,"$1"),old_part:Pressbooks.oldPart.replace(/^part\-([0-9]+)$/i,"$1"),id:jQuery(e).attr("id").replace(/^chapter\-([0-9]+)$/i,"$1"),_ajax_nonce:PB_OrganizeToken.orderNonce},cache:!1,dataType:"html",error:function(e,t,a){jQuery("#message").html('<p><strong>There has been an error updating your chapter data Usually, <a href="'+window.location.href+'">refreshing the page</a> helps.</strong></p>').addClass("error")},success:function(e){"NOCHANGE"==e&&jQuery("#message").html("<p><strong>No changes were registered.</strong></p>").addClass("error")},complete:function(){jQuery.unblockUI()}})},fmupdate:function(e){jQuery.ajax({beforeSend:function(){jQuery.blockUI.defaults.applyPlatformOpacityRules=!1,jQuery.blockUI({message:jQuery("#loader.fm")})},url:ajaxurl,type:"POST",data:{action:"pb_update_front_matter",front_matter_order:jQuery("#front-matter").sortable("serialize"),_ajax_nonce:PB_OrganizeToken.orderNonce},cache:!1,dataType:"html",error:function(e,t,a){jQuery("#message").html('<p><strong>There has been an error updating your front matter data Usually, <a href="'+window.location.href+'">refreshing the page</a> helps.</strong></p>').addClass("error")},success:function(e){"NOCHANGE"==e&&jQuery("#message").html("<p><strong>No changes were registered.</strong></p>").addClass("error")},complete:function(){jQuery.unblockUI()}})},bmupdate:function(e){jQuery.ajax({beforeSend:function(){jQuery.blockUI.defaults.applyPlatformOpacityRules=!1,jQuery.blockUI({message:jQuery("#loader.bm")})},url:ajaxurl,type:"POST",data:{action:"pb_update_back_matter",back_matter_order:jQuery("#back-matter").sortable("serialize"),_ajax_nonce:PB_OrganizeToken.orderNonce},cache:!1,dataType:"html",error:function(e,t,a){jQuery("#message").html('<p><strong>There has been an error updating your back matter data. Usually, <a href="'+window.location.href+'">refreshing the page</a> helps.</strong></p>').addClass("error")},success:function(e){"NOCHANGE"==e&&jQuery("#message").html("<p><strong>No changes were registered.</strong></p>").addClass("error")},complete:function(){jQuery.unblockUI()}})}};jQuery(document).ready(function($){$("table.chapters").sortable(Pressbooks.defaultOptions).disableSelection(),$("table#front-matter").sortable(Pressbooks.frontMatterOptions).disableSelection(),$("table#back-matter").sortable(Pressbooks.backMatterOptions).disableSelection(),$("input[name=blog_public]").change(function(){var e=$("input[name=blog_public]:checked").val();$.ajax({url:ajaxurl,type:"POST",data:{action:"pb_update_global_privacy_options",blog_public:e,_ajax_nonce:PB_OrganizeToken.privacyNonce},beforeSend:function(){0==e?($("h4.publicize-alert > span").text(PB_OrganizeToken["private"]),$("label span.public").css("font-weight","normal"),$("label span.private").css("font-weight","bold"),$(".publicize-alert").removeClass("public").addClass("private")):($("h4.publicize-alert > span").text(PB_OrganizeToken["public"]),$("label span.public").css("font-weight","bold"),$("label span.private").css("font-weight","normal"),$(".publicize-alert").removeClass("private").addClass("public"))},error:function(e,t,a){}})}),$(".chapter_privacy").change(function(){var e=$(this).parent().prev(".column-status"),t=$(this).attr("id");t=t.split("_"),t=t[t.length-1],$(this).is(":checked")?post_status="private":post_status="publish",$.ajax({url:ajaxurl,type:"POST",data:{action:"pb_update_privacy_options",post_id:t,post_status:post_status,_ajax_nonce:PB_OrganizeToken.privacyNonce},beforeSend:function(){"private"==post_status?e.text(PB_OrganizeToken["private"]):e.text(PB_OrganizeToken.published)},error:function(e,t,a){}})}),$(".chapter_export_check").change(function(){var e=$(this).attr("id");e=e.split("_"),e=e[e.length-1],$(this).is(":checked")?chapter_export=1:chapter_export=0,$.ajax({url:ajaxurl,type:"POST",data:{action:"pb_update_export_options",post_id:e,chapter_export:chapter_export,type:"pb_export",_ajax_nonce:PB_OrganizeToken.exportNonce}})}),$(".fm_privacy").change(function(){var e=$(this).parent().prev(".column-status"),t=$(this).attr("id");t=t.split("_"),t=t[t.length-1],$(this).is(":checked")?post_status="private":post_status="publish",$.ajax({url:ajaxurl,type:"POST",data:{action:"pb_update_privacy_options",post_id:t,post_status:post_status,_ajax_nonce:PB_OrganizeToken.privacyNonce},beforeSend:function(){"private"==post_status?e.text(PB_OrganizeToken["private"]):e.text(PB_OrganizeToken.published)},error:function(e,t,a){}})}),$(".fm_export_check").change(function(){var e=$(this).attr("id");e=e.split("_"),e=e[e.length-1],$(this).is(":checked")?chapter_export=1:chapter_export=0,$.ajax({url:ajaxurl,type:"POST",data:{action:"pb_update_export_options",post_id:e,chapter_export:chapter_export,type:"pb_export",_ajax_nonce:PB_OrganizeToken.exportNonce}})}),$(".bm_privacy").change(function(){var e=$(this).parent().prev(".column-status"),t=$(this).attr("id");t=t.split("_"),t=t[t.length-1],$(this).is(":checked")?post_status="private":post_status="publish",$.ajax({url:ajaxurl,type:"POST",data:{action:"pb_update_privacy_options",post_id:t,post_status:post_status,_ajax_nonce:PB_OrganizeToken.privacyNonce},beforeSend:function(){"private"==post_status?e.text(PB_OrganizeToken["private"]):e.text(PB_OrganizeToken.published)},error:function(e,t,a){}})}),$(".bm_export_check").change(function(){var e=$(this).attr("id");e=e.split("_"),e=e[e.length-1],$(this).is(":checked")?chapter_export=1:chapter_export=0,$.ajax({url:ajaxurl,type:"POST",data:{action:"pb_update_export_options",post_id:e,chapter_export:chapter_export,type:"pb_export",_ajax_nonce:PB_OrganizeToken.exportNonce}})})});